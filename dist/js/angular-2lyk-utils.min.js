angular.module("2lykUtils",["ngStorage"]),angular.module("2lykUtils").provider("lykConsole",function(){function a(a,c){b&&(Array.prototype.unshift.call(c,"[DEV]"),a.apply(a,c))}var b=!1;this.setDev=function(a){b=a},this.dev=function(){a(console.debug,arguments)},this.$get=["$log",function(b){function c(){var a=arguments[0];return angular.isString(a)&&m[a]?Array.prototype.shift.call(arguments):a="log",m[a].apply(this,arguments)}function d(){if(!(arguments.length<2)){arguments[0];return!!arguments[1]&&(Array.prototype.splice.call(arguments,1,1),c.apply(this,arguments),!0)}}function e(){b.log.apply(this,arguments)}function f(){b.info.apply(this,arguments)}function g(){b.warn.apply(this,arguments)}function h(){b.error.apply(this,arguments)}function i(){b.debug.apply(this,arguments)}function j(){for(var a="",c=0;c<arguments.length;c++)a+=angular.isString(arguments[c])?" "+arguments[c]:" "+JSON.stringify(arguments[c]);a+=" ",b.log.apply(this,["%c"+a,"background-color: black; color: #00FF00;"])}function k(){a(i,arguments)}var l={call:c,trigger:d,log:e,info:f,warn:g,error:h,debug:i,matrix:j,dev:k},m={log:e,info:f,warn:g,error:h,debug:i,matrix:j};return l}]}),angular.module("2lykUtils").provider("lykXhr",function(){var a={};this.routes=function(b){b&&angular.isObject(b)&&(a=b,Object.keys(a).forEach(function(b){return"__apis"==b?delete a[b]:angular.isObject(a[b])&&angular.isString(a[b].url)?angular.isString(a[b].method)?void 0:a[b].method="GET":delete a[b]}))},this.$get=["$q","$http","lykConsole",function(b,c,d){function e(){return Array.prototype.splice.call(arguments,1,0,"[lykXhr] >"),Array.prototype.unshift.call(arguments,"error"),d.trigger.apply(this,arguments)}function f(b,c,d){c=c||{},d=d||{};var e=a[b],f={method:e.method,url:e.url};return Object.keys(d).forEach(function(a){var b=new RegExp("{"+a+"}","g");f.url=f.url.replace(b,d[a])}),Object.keys(c).forEach(function(a){"method"!=a.toLowerCase()&&"url"!=a.toLowerCase()&&(f[a]=c[a])}),f}var g=function(b){return"__apis"==b?h():angular.copy(a[b])},h=function(){return angular.copy(a)},i=function(d,g,h){var i=b.defer();if(a[d])c(f(d,g,h)).then(function(a){i.resolve(a.data)},function(a){i.reject(a)});else{var j=Object.keys(a).filter(function(a){return a.indexOf(d)!=-1}),k='"'+d+'" is undefined. ';e(j.length>0,"[execute]",k+"Did you mean:",j.join(", "),"?")||e(!0,"[execute]",k),i.reject({data:k,proposals:j})}return i.promise};return{get:g,getAll:h,set:function(b,c){if(!(e(!angular.isString(b),"[set]","Argument 1 must be a string.","Instead, received: "+typeof b)||e("__apis"==b,"[set]","Argument 1:",'"__apis" is reserved')||e(!angular.isObject(c),"[set]","Argument 2 must be an object.","Instead, received: "+typeof c)||e(!angular.isString(c.url),"[set]","Within argument 2, url must be a string","Instead, received: "+typeof c.url)))return a[b]=c,this},execute:i,buildConfig:f}}]}),angular.module("2lykUtils").factory("JoiSchemaUtils",["lykConsole",function(a){function b(){return Array.prototype.splice.call(arguments,1,0,"[JoiSchemaUtils] >"),Array.prototype.unshift.call(arguments,"error"),a.trigger.apply(this,arguments)}function c(a,c,d){if(!b(!angular.isString(c),d,"Argument 2 must be a string.","Instead, received: "+typeof c)&&a&&angular.isObject(a)&&angular.isObject(a[c])&&a[c].isJoi)return!0}function d(a,b){if(c(a,b,"[getValids]"))return a[b]._valids._set}function e(a,b){if(c(a,b,"[getInvalids]"))return a[b]._invalids._set}function f(a,b){if(c(a,b,"[getUnit]"))return a[b]._unit}function g(a,b){if(c(a,b,"[getType]"))return a[b]._type}function h(a,b){if(c(a,b,"[isRequired]"))return"required"==a[b]._flags.presence}return{getValids:d,getInvalids:e,getUnit:f,getType:g,isRequired:h}}]),angular.module("2lykUtils").factory("lykPropertyAccess",["lykConsole","$q",function(a,b){function c(){return Array.prototype.splice.call(arguments,1,0,"[lykPropertyAccess] >"),Array.prototype.unshift.call(arguments,"error"),a.trigger.apply(this,arguments)}function d(a,b,d){if(!c(!angular.isObject(b)&&!angular.isArray(b),a,"Argument 1 must be an object or an array.","Instead, received: "+typeof b)&&!c(!angular.isString(d),a,"Argument 2 must be a string.","Instead, received: "+typeof d))return!0}function e(a,b){return m(h,a,b)}function f(a,b){return m(i,a,b)}function g(a,b,c){return m(j,a,b,c)}function h(a,b){var c=i(a,b);return"[object Array]"===Object.prototype.toString.call(c)?"array":typeof c}function i(a,b){if(d("[getValue]",a,b))return l(a,b).value}function j(a,b,c){if(d("[setValue]",a,b)){var e=l(a,b);e.isReadable&&(e.previous[e.lastKey]=c)}}function k(a,b){if(d("[isReadable]",a,b))return l(a,b).isReadable}function l(a,b){for(var c,d=n(b),e=a,f=e,g=0;g<d.length;){var h=d[g];if(c=h,f=e,e=e[h],!angular.isObject(e)&&g<d.length-1){e&&(f=e,e=void 0);break}g++}return{isReadable:g>=d.length,value:e,data:a,previous:f,lastKey:c}}function m(a,c,d,e){return b(function(b,f){return b(a(c,d,e))})}function n(a){return a=a.trim(),a.indexOf(".")>-1?a.split("."):a.startsWith("[")&&a.endsWith("]")?(a=a.substring(1,a.length-1),a.split(/[\[\]]+/)):a.split(".")}var o={split:n,isReadable:k,getValue:i,setValue:j,getType:h,async:{getValue:f,setValue:g,getType:e}};return o}]),angular.module("2lykUtils").factory("lykTmp",["lykXhr","$http","$q","$interval","$sessionStorage",function(a,b,c,d,e){function f(d,f,h){return angular.isString(d)&&(d={name:d}),c(function(c,k){f=f||j;var l,m=a.buildConfig(d.name,d.config,d.params);l=h?e[f]:i[f];var n,o=m.method?m.method.toUpperCase():"GET",p=m.url;if(l&&l[o]&&l[o][p]){n=l[o];var q=n[p];if(!q.value||q.value&&q.value.$$state&&2==q.value.$$state.status){if(console.warn("another try to retrieve"),!(q.try<3))return k(q);q.try++}else if(q.expiredAt&&new Date(q.expiredAt).getTime()>(new Date).getTime())return console.warn("get from tmp:",f,q),q.saved&&!q.value.$$state?c(q.saved):g(q.value,c,k)}else l||(h?(e[f]={},l=e[f]):(i[f]={},l=i[f])),l[o]||(l[o]={}),n=l[o];var r=new Date;return r.setSeconds(r.getSeconds()+5+60),n[p]||(n[p]={try:1}),n[p].expiredAt=r,n[p].value=b(m).then(function(a){return h&&(n[p].saved=a),a},function(a){return a}),g(n[p].value,c,k)})}function g(a,b,c){function e(){d.cancel(h)}var f=!1,g=total=50,h=d(function(){if(a.$$state&&a.$$state.status,a.$$state&&0!=a.$$state.status&&!f){f=!0;var d=a.$$state.value;return e(total),2==a.$$state.status?c(d):b(d)}if(--g<=0)return e(total),console.error("There has been a problem with the service lykTmp"),c(a)},500,total)}var h={get:f},i={},j="[tmp]";return h}]);